---
title: Может ли смарт контракт инициировать транзакцию?
tags: [EVM, Ethereum, Smart Contract, Транзакции, Взаимодействие контрактов]
---

## Короткий ответ

Да, смарт-контракт может инициировать транзакцию в Ethereum.


## Подробный разбор

Смарт-контракты в Ethereum не пассивные сущности. Они могут активно взаимодействовать с другими контрактами и EOA,  в том числе инициировать новые транзакции.  Это достигается с помощью  **внутренних транзакций (internal transactions)**  или  **межконтрактных вызовов (contract-to-contract calls)**.

**Как это работает?**

Когда смарт-контракт вызывает функцию другого контракта, это приводит к созданию внутренней транзакции.  Эта транзакция выполняется в контексте вызывающего контракта, но не требует подписи пользователя и не оплачивается gas напрямую пользователем (gas оплачивается из gas, предоставленного для выполнения исходной транзакции).

**Способы инициирования транзакций:**

* **Прямой вызов функции другого контракта:** Контракт может вызвать функцию другого контракта, используя  `address.call(data)` или другие low-level методы.
* **Использование специальных функций, таких как `selfdestruct`:** Функция `selfdestruct` позволяет контракту самоуничтожиться и отправить свой баланс на указанный адрес.  Это также инициирует транзакцию.
* **Создание новых контрактов:** Контракт может создавать новые контракты, используя  opcode `CREATE` или `CREATE2`.  Это также инициирует транзакцию для развертывания нового контракта.


**Ограничения:**

* Gas Limit: Внутренние транзакции ограничены gas limit'ом, установленным для исходной транзакции.
* Reentrancy attacks (атаки повторного входа):  При вызове внешних контрактов необходимо учитывать возможность  reentrancy attacks.


## Связанные темы

* [Вернуться к списку вопросов](4.%20Список%20вопросов.md)
* [[Что такое SmartContract? Может ли иметь приватный ключ? Может ли хранить произвольные данные ? Может ли хранить код? Кто контролирует аккаунт?]]
* [[Как транзакция выполняется на уровне EVM? Может ли измениться code storage аккаунта? Что происходит со storage аккаунта?]]
* [[Что такое атомарность транзакций?]]


## Источники

* [Ethereum Documentation - Contract Interaction](https://ethereum.org/en/developers/docs/smart-contracts/anatomy/#contract-interaction)
* [Solidity Documentation - Calling Other Contracts](https://docs.soliditylang.org/en/v0.8.17/contracts.html#calling-other-contracts)
* [ConsenSys - Smart Contract Best Practices - Reentrancy](https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/) 
* [Ethereum Stack Exchange - How do contracts initiate transactions?](https://ethereum.stackexchange.com/questions/3618/how-do-contracts-initiate-transactions) 


---