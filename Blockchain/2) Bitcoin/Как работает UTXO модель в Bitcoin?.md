
**Короткий ответ**: UTXO (Unspent Transaction Output) — это модель управления балансами в Bitcoin. Она хранит непотраченные выходы транзакций, которые используются в качестве входов для новых транзакций. UTXO обеспечивает децентрализованный учёт средств и их верификацию.

---

## Подробный разбор

### Основные понятия

1. **UTXO (Unspent Transaction Output)**:
   - Непотраченный выход транзакции — это "монета", которая может быть использована в будущей транзакции.
   - Каждая транзакция создаёт новые выходы, которые становятся UTXO.

2. **Inputs и Outputs**:
   - **Inputs**: Ссылаются на UTXO, которые используются для финансирования новой транзакции.
   - **Outputs**: Создают новые UTXO для передачи средств.

3. **UTXO Pool**:
   - Узлы сети хранят список всех доступных UTXO, который обновляется с добавлением новых транзакций.

---

### Как работает UTXO модель?

1. **Создание UTXO**:
   - Когда транзакция добавляется в блокчейн, её выходы становятся UTXO, если они ещё не были использованы.

2. **Расходование UTXO**:
   - Чтобы потратить средства, пользователь должен создать входы, ссылающиеся на существующие UTXO.
   - Каждая ссылка должна сопровождаться цифровой подписью, доказывающей право владельца распоряжаться средствами.

3. **Обновление UTXO Pool**:
   - После включения транзакции в блок:
     - UTXO, на которые ссылаются входы, удаляются из пула.
     - Выходы новой транзакции добавляются в пул как новые UTXO.

---

### Пример

1. **Изначальная транзакция**:
   - Выходы: 
     - Output 1: 0.5 BTC → Alice (UTXO).
     - Output 2: 0.5 BTC → Bob (UTXO).

2. **Новая транзакция**:
   - Input: UTXO (Output 1 → Alice).
   - Outputs:
     - 0.3 BTC → Charlie.
     - 0.2 BTC → Alice (сдача).

3. **Обновление UTXO Pool**:
   - Output 1 удаляется из пула (потрачен).
   - Добавляются два новых UTXO:
     - 0.3 BTC → Charlie.
     - 0.2 BTC → Alice.

---

### Преимущества UTXO модели

1. **Прозрачность**:
   - Любой узел сети может проверить баланс адреса, отслеживая его UTXO.

2. **Безопасность**:
   - Средства защищены цифровой подписью, а транзакции легко верифицируются.

3. **Децентрализация**:
   - Узлы не хранят балансы напрямую, что упрощает синхронизацию и распределённое хранение.

---

### Ограничения UTXO модели

1. **Фрагментация**:
   - Множество небольших UTXO (например, сдача) увеличивают объём транзакций и комиссии.

2. **Отсутствие прямого учёта балансов**:
   - Для определения баланса адреса требуется просканировать все доступные UTXO.

---

### Отличие от модели балансов (Ethereum)

| Параметр                | UTXO (Bitcoin)                     | Балансовая модель (Ethereum)       |
|-------------------------|-------------------------------------|------------------------------------|
| Единицы учёта           | Непотраченные выходы (UTXO)        | Состояния счёта (баланс)          |
| Структура               | Линейная связь входов и выходов    | Централизованный учёт балансов    |
| Сложность верификации   | Умеренная                          | Прямая проверка баланса           |
### Lightning Network

![[Screenshot 2024-11-21 at 23.03.24.png]]

![[Screenshot 2024-11-21 at 23.10.40.png]]

![[Screenshot 2024-11-21 at 23.08.37.png]]
---

### Связанные темы
- [[Структура транзакций, какие поля имеются и для чего нужны?]]
- [[Как Public Key и Private Key связан с UTXO?]]
- [[P2PKH как работает алгоритм?]]

---

### Источники
1. [Bitcoin Developer Guide: UTXO](https://bitcoin.org/en/developer-guide#unspent-transaction-output)
2. [How Bitcoin's UTXO Model Works](https://en.bitcoin.it/wiki/UTXO)
3. [Bitcoin Transactions Explained](https://medium.com/@aantonop/bitcoin-transaction-inputs-and-outputs-8d6a5d8fbc4a)