
**Короткий ответ**: Блоки объединяют транзакции для упрощения обработки, проверки и синхронизации данных между узлами сети. Это обеспечивает неизменность цепочки, повышает безопасность и упрощает процесс валидации.

---

## Подробный разбор

### Почему используют блоки?

1. **Эффективность**:
   - Блоки позволяют группировать большое количество транзакций, чтобы они обрабатывались одной операцией. Это снижает нагрузку на сеть.

2. **Неизменность данных**:
   - Блок содержит хэш предыдущего блока, транзакции и вспомогательные данные, что формирует **цепочку блоков (blockchain)**. Изменение одного блока затронет всю цепочку, защищая данные от подделки.

3. **Оптимизация майнинга**:
   - Майнеры работают над созданием одного блока, а не каждой транзакции по отдельности. Это делает процесс консенсуса более масштабируемым.

4. **Согласованность сети**:
   - Блоки помогают синхронизировать состояние сети, так как все узлы проверяют и добавляют блоки в свою локальную копию цепочки.

---

### Зачем блоки вместо отдельных транзакций?

- **Скорость обработки**: Проверка и передача одного блока с десятками транзакций быстрее, чем передача и обработка каждой транзакции отдельно.
- **Упрощение структуры данных**: Блоки формируют структуру, которая позволяет эффективно отслеживать и проверять транзакции.
- **Экономия ресурсов**: Снижение количества операций передачи данных между узлами сети.

---

### Пример
Если бы каждая транзакция передавалась и подтверждалась отдельно:
- Узлы сети перегружались бы из-за постоянных операций.
- Проверка консенсуса для каждой транзакции заняла бы больше времени.

Использование блоков позволяет включать десятки или сотни транзакций в один хэшированный объект, оптимизируя процесс.

---

### Структура блока в Bitcoin (с SegWit)

1. **Заголовок блока (Block Header)**:
   - **Версия блока**: Указывает на протокол.
   - **Хэш предыдущего блока**: Ссылка на предыдущий блок, обеспечивающая связь блоков в цепочке.
   - **Merkle Root**: Хэш дерева Меркла, включающего все транзакции блока.
   - **Временная метка (Timestamp)**: Указывает время создания блока.
   - **Сложность (Bits)**: Уровень сложности задачи майнинга.
   - **Nonce**: Число, которое майнер изменяет для поиска правильного хэша.

2. **Транзакции**:
   - Список транзакций, включая:
     - Входы (inputs) и выходы (outputs).
     - Witness данные (в случае SegWit).
   - **Coinbase транзакция**:
     - Первая транзакция в блоке.
     - Награда майнеру за добавление блока.

3. **Witness данные** (с SegWit):
   - Хранят подписи и публичные ключи для транзакций, отделённые от основной части блока.
   - Снижают размер основной структуры транзакций, увеличивая пропускную способность.

---

### Как это связано с хэшем и подписями?

1. **Хэширование**:
   - Каждый блок имеет уникальный хэш, рассчитанный из его заголовка (включая Merkle Root).
   - Хэш защищает данные блока: изменение любой транзакции изменит Merkle Root и, следовательно, хэш блока.
   - Хэш предыдущего блока в заголовке обеспечивает связь между блоками.

2. **Цифровые подписи**:
   - Каждая транзакция подписывается приватным ключом отправителя.
   - Подписи хранятся в `Witness` (для SegWit) или `ScriptSig` (до SegWit).
   - Узлы сети проверяют подписи для подтверждения валидности транзакций.

---

### Связанные темы
- [[Как связаны блоки в цепочке?]]
- [[Используется ли MerkleTree в блоке? Если да, то для чего?]]
- [[Как работает модель балансов в Ethereum?]]

---

### Источники
1. [Bitcoin Whitepaper](https://bitcoin.org/bitcoin.pdf)
2. [Blockchain Basics on Bitcoin Wiki](https://en.bitcoin.it/wiki/Block)
3. [Bitcoin Developer Guide: SegWit](https://bitcoin.org/en/developer-guide#segregated-witness)