
**Короткий ответ**: Физический размер транзакции — это её реальный объём данных (в байтах). Вес транзакции — это величина, которая используется для расчёта, сколько "весовых единиц" занимает транзакция в блоке. Вес учитывает Base и Witness части транзакции с разными коэффициентами, чтобы эффективнее использовать пространство блока.

---

## Подробный разбор

### Физический размер транзакции

1. **Что такое физический размер?**
   - Это количество байтов, из которых состоит транзакция:
     - Входы (inputs): адреса отправителей, цифровые подписи, публичные ключи.
     - Выходы (outputs): адреса получателей, суммы.
   - Размер зависит от структуры транзакции и количества входов/выходов.

2. **Пример размера транзакции**:
   - Простая транзакция с одним входом и одним выходом:
     - Input (вход): 148 байт.
     - Output (выход): 34 байта.
     - Прочие данные (версия, locktime): 10 байт.
     - Итоговый физический размер: \(148 + 34 + 10 = 192\) байта.

---

### Что такое вес транзакции?

1. **Понятие веса**:
   - Вес — это показатель, который рассчитывается для каждой транзакции и используется для определения её "стоимости" в блоке.
   - Введён в SegWit, чтобы отличать Base и Witness данные.

2. **Как рассчитывается вес?**
   - Формула:
     $$
     Weight = size_{base} \times 3 + size_{witness}
     $$
   - Base часть: основные данные транзакции (без подписей).
   - Witness часть: подписи и публичные ключи.

3. **Пример**:
   - Транзакция:
     - Base: 120 байт.
     - Witness: 72 байта.
   - Вес:
     $$
     Weight = 120 \times 3 + 72 = 432
     $$

---

### Зачем вводится вес?

1. **Оптимизация использования блока**:
   - Witness данные учитываются с меньшим весом (1:1), так как они менее важны для структуры транзакции.
   - Base данные имеют больший вес (3:1), так как они определяют ключевую информацию (входы, выходы).

2. **Пример эффекта веса**:
   - Без SegWit:
     - Транзакция размером 192 байта занимает весь физический размер в блоке.
   - С SegWit:
     - Base часть: 120 байт.
     - Witness часть: 72 байта.
     - Вес: 432 весовых единицы (меньше, чем эквивалент 576 весовых единиц без SegWit).

3. **Эффективный размер блока**:
   - Ограничение 1 МБ в Bitcoin до SegWit означало 1 МБ физического размера.
   - С SegWit блок может включать до 4 млн весовых единиц, что позволяет хранить до 4 МБ данных.

---

### Пример транзакции

#### Без SegWit:
- Физический размер = Вес.
- Транзакция: 400 байт.
- Блок: ограничен 1 МБ (2500 транзакций по 400 байт).
#### С SegWit:
- Base: 200 байт.
- Witness: 200 байт.
- Вес:
  $$
  Weight = (200 \times 3) + 200 = 800
  $$
- В блоке (4 млн весовых единиц):
  - Вмещается $$( \frac{4\,000\,000}{800} = 5000) $$ транзакций.

---

### Итоговая связь веса и размера

1. **Физический размер**:
   - Реальный объём данных транзакции в байтах.
   - Используется для передачи данных между узлами.

2. **Вес**:
   - Абстракция, используемая для расчёта "стоимости" транзакции в блоке.
   - Учитывает важность Base и Witness частей.

3. **Влияние SegWit**:
   - Уменьшает вес Witness части.
   - Увеличивает эффективное количество транзакций в блоке за счёт меньшего веса.

---

### Связанные темы
- [[Что такое SegWit?]]
- [[Difficulty & Target в чем отличие?]]
- [[Структура транзакций, какие поля имеются и для чего нужны?]]

---

### Источники
1. [Bitcoin Developer Guide: SegWit](https://bitcoin.org/en/developer-guide#segregated-witness)
2. [Understanding Bitcoin Block Weight](https://medium.com/@mypersonality/understanding-bitcoin-block-weight-7ef44e127b16)
3. [SegWit Weight and Size](https://en.bitcoin.it/wiki/Weight)