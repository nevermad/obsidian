

**Короткий ответ**: Nonce — это уникальный номер, который отслеживает количество транзакций, отправленных с аккаунта. Он предотвращает повторное использование транзакций (replay attacks) и обеспечивает корректный порядок выполнения операций в сети Ethereum.

---

## Подробный разбор

### Что такое Nonce?

1. **Определение**:
   - Nonce — это целое число, увеличивающееся на единицу с каждой новой транзакцией, отправленной с аккаунта.
   - Начальное значение Nonce равно 0.

2. **Где используется?**
   - Nonce включён в каждую транзакцию Ethereum и проверяется узлами сети перед её выполнением.

---

### Зачем нужен Nonce?

1. **Предотвращение replay attacks**:
   - Replay attack — это повторная отправка одной и той же транзакции.
   - Nonce позволяет сети убедиться, что каждая транзакция уникальна.

2. **Обеспечение порядка выполнения**:
   - Узлы проверяют, что Nonce транзакции соответствует следующему ожидаемому значению.
   - Транзакции с неправильным Nonce отклоняются.

3. **Синхронизация в mempool**:
   - Узлы сети сортируют транзакции по Nonce, чтобы избежать пропусков или неправильного порядка.

---

### Как работает Nonce?

1. **Отправка транзакции**:
   - У аккаунта с Nonce = 5 отправляется новая транзакция.
   - Nonce этой транзакции будет равен 5.

2. **Проверка узлами**:
   - Узлы сети проверяют:
     - Nonce транзакции = текущий Nonce аккаунта.
     - Если Nonce меньше ожидаемого, транзакция отклоняется.
     - Если Nonce больше ожидаемого, транзакция откладывается до получения пропущенных.

3. **Обновление Nonce**:
   - После успешной обработки транзакции Nonce аккаунта увеличивается на 1.

---

### Пример использования

1. **Последовательность транзакций**:
   - Отправитель: аккаунт с Nonce = 3.
   - Отправляются три транзакции:
     - Транзакция A: Nonce = 3.
     - Транзакция B: Nonce = 4.
     - Транзакция C: Nonce = 5.

2. **Если транзакция с Nonce = 4 (B) потерялась**:
   - Транзакция с Nonce = 5 (C) откладывается в mempool, пока не будет обработана транзакция с Nonce = 4.

---

### Nonce в других контекстах

1. **Proof of Work (Bitcoin)**:
   - В Bitcoin Nonce используется для поиска правильного хэша блока, но не связан с аккаунтами.

2. **Смарт-контракты**:
   - В Ethereum Nonce также используется для уникальности адресов, создаваемых смарт-контрактами:
     - Новый адрес контракта определяется Nonce аккаунта, его создавшего.

---

### Зачем учитывать Nonce при написании DApps?

1. **Порядок транзакций**:
   - DApps должны отслеживать Nonce аккаунтов, чтобы транзакции отправлялись последовательно.

2. **Обработка отклонённых транзакций**:
   - Неправильное управление Nonce может привести к застреванию транзакций в mempool.

3. **Уникальность операций**:
   - Nonce гарантирует, что каждая операция будет выполнена ровно один раз.

---

### Связанные темы
- [[Что такое Gas?]]
- [[Как работает модель балансов в Ethereum?]]
- [[Время создания блока Bitcoin & Ethereum? Ваши мысли почему такое время?]]

---

### Источники
1. [Ethereum Documentation: Nonce](https://ethereum.org/en/developers/docs/transactions/)
2. [Understanding Ethereum Nonce](https://medium.com/@mycrypto/ethereum-nonces-explained-271d8921280e)
3. [Replay Attacks in Blockchain](https://cryptosec.info/replay-attacks/)