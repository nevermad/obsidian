
**Короткий ответ**: Public Key (публичный ключ) используется для указания владельца UTXO, а Private Key (приватный ключ) необходим для создания цифровой подписи, которая позволяет потратить соответствующее UTXO. Эти ключи связаны через криптографическую пару в модели асимметричной криптографии.

---

## Подробный разбор

### Роль ключей в UTXO

1. **Public Key**:
   - Публичный ключ создаётся из приватного ключа.
   - Для указания владельца UTXO в блокчейне используется хэш публичного ключа (**Public Key Hash**).
   - Пример:
     - **Адрес** получателя UTXO — это хэш публичного ключа, представленный в формате Base58 (например, Bitcoin-адрес).

2. **Private Key**:
   - Приватный ключ используется для создания цифровой подписи.
   - Подпись доказывает, что владелец UTXO даёт разрешение на его использование.

---

### Связь Public Key и UTXO

1. **Создание UTXO**:
   - Отправитель создаёт выход транзакции, указывая адрес (хэш публичного ключа) получателя.
   - Этот выход становится доступным для владельца публичного ключа.

2. **Расходование UTXO**:
   - Чтобы потратить UTXO, владелец должен предоставить:
     - Публичный ключ.
     - Подпись, созданную с использованием приватного ключа.
   - Узлы сети проверяют подпись, используя предоставленный публичный ключ.

---

### Механизм проверки транзакции

1. **Разблокировка UTXO**:
   - Каждый вход транзакции содержит скрипт ScriptSig, в котором передаются:
     - Публичный ключ.
     - Подпись.

2. **Скрипт блокировки (ScriptPubKey)**:
   - ScriptPubKey из UTXO проверяет, что:
     - Хэш публичного ключа совпадает с указанным в UTXO.
     - Подпись валидна для данной транзакции.

---

### Пример использования

1. **Создание UTXO**:
   - Alice отправляет 1 BTC Bob.
   - В выходе транзакции указывается:
     - **Value**: 1 BTC.
     - **ScriptPubKey**: `OP_DUP OP_HASH160 <Bob's Public Key Hash> OP_EQUALVERIFY OP_CHECKSIG`.

2. **Расходование UTXO**:
   - Bob хочет отправить 0.5 BTC Charlie.
   - Bob добавляет в вход транзакции:
     - Свой публичный ключ.
     - Подпись, созданную приватным ключом.
   - Узлы проверяют:
     - Хэш публичного ключа соответствует ScriptPubKey.
     - Подпись валидна.

---

### Преимущества использования ключей в UTXO

1. **Безопасность**:
   - Только владелец приватного ключа может подписывать транзакции, что предотвращает несанкционированный доступ.

2. **Прозрачность**:
   - Любой узел сети может проверить подпись и убедиться в её подлинности.

3. **Неизменность**:
   - Включение транзакции в блокчейн делает невозможным её изменение без пересчёта всей цепочки блоков.

---

### Связанные темы
- [[P2PKH как работает алгоритм?]]
- [[Структура транзакций, какие поля имеются и для чего нужны?]]
- [[Как работает UTXO модель в Bitcoin?]]

---

### Источники
1. [Bitcoin Developer Guide: UTXO](https://bitcoin.org/en/developer-guide#unspent-transaction-output)
2. [Digital Signatures in Bitcoin](https://en.bitcoin.it/wiki/Script)
3. [How Bitcoin Transactions Use Public and Private Keys](https://medium.com/@aantonop/bitcoin-transaction-inputs-and-outputs-8d6a5d8fbc4a)