
**Короткий ответ**: P2PKH (Pay-to-Public-Key-Hash) — это стандартный метод отправки Bitcoin, при котором средства блокируются хэшем публичного ключа получателя. Для их разблокировки отправитель должен предоставить публичный ключ и цифровую подпись, которые проверяются с помощью ScriptPubKey.

---

## Подробный разбор

### Что такое P2PKH?
- P2PKH — это механизм, при котором средства "привязываются" к хэшу публичного ключа получателя.
- Транзакция считается успешной, если:
  1. Публичный ключ владельца совпадает с указанным хэшем.
  2. Цифровая подпись валидна.

---

### Как работает P2PKH?

1. **Создание транзакции**:
   - Отправитель формирует выход (output), указывая:
     - **Value**: Сумма BTC.
     - **ScriptPubKey**: Скрипт, блокирующий средства, пока не будет предъявлена валидная подпись и публичный ключ.
   - Пример ScriptPubKey:
     ```
     OP_DUP OP_HASH160 <Public Key Hash> OP_EQUALVERIFY OP_CHECKSIG
     ```

2. **Расходование средств**:
   - Чтобы потратить средства, владелец предоставляет:
     - Публичный ключ (Public Key).
     - Подпись, созданную приватным ключом.
   - ScriptSig:
     ```
     <Signature> <Public Key>
     ```

3. **Проверка**:
   - ScriptSig (подпись и публичный ключ) соединяется с ScriptPubKey, и выполняются проверки:
     - Хэш публичного ключа совпадает с записанным.
     - Подпись валидна для предоставленного публичного ключа и данных транзакции.

---

### Этапы выполнения скриптов

1. **ScriptPubKey (блокировка)**:
   - Команды:
     - `OP_DUP`: Дублирует публичный ключ в стеке.
     - `OP_HASH160`: Вычисляет хэш публичного ключа.
     - `OP_EQUALVERIFY`: Проверяет совпадение хэшей.
     - `OP_CHECKSIG`: Проверяет валидность подписи.

2. **ScriptSig (разблокировка)**:
   - Переданные данные:
     - Подпись.
     - Публичный ключ.

3. **Результат**:
   - Если все проверки успешны, средства разблокируются.

---

### Пример

1. **Alice отправляет 1 BTC Bob**:
   - ScriptPubKey:
     ```
     OP_DUP OP_HASH160 <Bob's Public Key Hash> OP_EQUALVERIFY OP_CHECKSIG
     ```

2. **Bob тратит средства**:
   - ScriptSig:
     ```
     <Signature> <Bob's Public Key>
     ```
   - Проверки:
     - Хэш публичного ключа совпадает с <Bob's Public Key Hash>.
     - Подпись валидна.

---

### Преимущества P2PKH

1. **Безопасность**:
   - Средства могут быть потрачены только владельцем соответствующего приватного ключа.

2. **Компактность**:
   - Хранится только хэш публичного ключа, а сам ключ раскрывается только при расходовании средств.

3. **Совместимость**:
   - P2PKH поддерживается всеми Bitcoin-кошельками.

---

### Связанные темы
- [[Как работает UTXO модель в Bitcoin?]]
- [[Структура транзакций, какие поля имеются и для чего нужны?]]
- [[Как Public Key и Private Key связан с UTXO?]]

---

### Источники
1. [Bitcoin Developer Guide: P2PKH](https://bitcoin.org/en/developer-guide#standard-transactions)
2. [Bitcoin Wiki: Pay-to-Pubkey-Hash](https://en.bitcoin.it/wiki/Pay-to-Pubkey_Hash)
3. [Understanding P2PKH](https://medium.com/coinmonks/understanding-p2pkh-transactions-9a29d321d7a1)