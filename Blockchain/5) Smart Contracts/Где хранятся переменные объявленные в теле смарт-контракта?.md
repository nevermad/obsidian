
## Короткий ответ

Переменные, объявленные в теле смарт-контракта, хранятся в `storage`. Это постоянное хранилище, которое сохраняется в блокчейне и существует на протяжении всего жизненного цикла контракта. Данные в `storage` изменяемы и требуют затрат газа при записи или чтении.

---

## Подробный разбор

### **Что такое storage?**
- **Определение:**
  - `storage` — это постоянное хранилище, которое используется для хранения переменных состояния контракта.
  - Данные в `storage` сохраняются в блокчейне и остаются доступными даже после завершения выполнения функции.

- **Пример:**
  ```solidity
  contract Example {
      uint public value; // Хранится в storage
  }
  ```

### **Особенности storage**
1. **Постоянство данных:**
   - Переменные в `storage` сохраняются между вызовами функций.
   - Например, если вы измените значение переменной в одной транзакции, оно останется таким же в следующей.

2. **Затраты газа:**
   - Чтение и запись данных в `storage` требует значительных затрат газа.
   - Операции с `storage` дороже, чем с `memory` или `calldata`.

3. **Инициализация:**
   - Переменные в `storage` автоматически инициализируются дефолтными значениями (например, `0` для чисел, `false` для булевых значений).

### **Как данные организованы в storage?**
- Данные хранятся в слотах памяти (`storage slots`), каждый из которых имеет размер 32 байта.
- Номер слота определяется порядком объявления переменных в контракте.

- **Пример:**
  ```solidity
  contract StorageExample {
      uint public a; // Слот 0
      uint public b; // Слот 1
      uint[] public arr; // Слот 2 (указатель на массив)
  }
  ```

### **Ограничения**
- Изменение данных в `storage` может быть дорогостоящим, особенно для сложных структур данных, таких как массивы или маппинги.
- Не рекомендуется часто изменять большие объемы данных в `storage`, так как это увеличивает расходы на газ.

---

## Связанные темы
- [Вернуться к списку вопросов](5.%20Список%20вопросов.md)
- [[Где хранятся переменные объявленные в теле функции смарт-контракта?]]
- [[Как расcчитывается номер слота для хранения переменных смарт-контракта?]]
- [[Какие типы данных есть в Solidity?]]

---

## Источники
- [Solidity Documentation - Storage](https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html#storage-memory-and-the-stack)
- [Understanding Ethereum Storage Layout](https://medium.com/@hayeah/diving-into-the-ethereum-vm-part-2-storage-layout-bc5349cb11b7)