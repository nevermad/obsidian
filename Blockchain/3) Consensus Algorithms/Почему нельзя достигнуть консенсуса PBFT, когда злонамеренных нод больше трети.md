[Вернуться к списку вопросов](3.%20Список%20вопросов)
## Короткий ответ

Консенсус PBFT невозможно достичь, если количество злонамеренных узлов превышает $$ \frac{N - 1}{3} $$, поскольку в таком случае честные узлы теряют большинство. Это нарушает ключевые предположения алгоритма о том, что честные узлы могут согласовать общее решение, несмотря на поведение злонамеренных участников.

---

## Подробный разбор

### Основные принципы PBFT

1. **Образование кворума**:
   - Для достижения согласия требуется, чтобы честные узлы составляли большинство:
     $$
     Honest = 2f + 1
     $$
   - Злонамеренные узлы не должны превышать:
     $$
     f \leq \frac{N - 1}{3}
     $$

2. **Согласованность сообщений**:
   - Честные узлы должны получать одинаковые сообщения, чтобы достичь согласованного решения.

---

### Что происходит при $$ f > \frac{N - 1}{3} $$?

1. **Недостаток честных узлов**:
   - Если \( f \) злонамеренных узлов превышает треть от общего числа узлов, то честные узлы не могут образовать большинство для принятия решений.

2. **Пример системы с \( N = 7 \)**:
   - Если \( f = 3 \):
     - Честных узлов:
       $$
       Honest = N - f = 7 - 3 = 4
       $$
     - Для кворума требуется:
       $$
       Honest = 2f + 1 = 7
       $$
     - Честных узлов недостаточно для формирования кворума.

3. **Атака на согласие**:
   - Злонамеренные узлы могут:
     - Рассылать противоречивую информацию.
     - Формировать альтернативные кворумы, нарушая согласие.

---

### Потенциальные последствия

1. **Несогласованное состояние**:
   - Узлы системы могут прийти к разным решениям, что нарушает целостность данных.

2. **Невозможность прогресса**:
   - Система не может достичь согласия, так как честные узлы не могут игнорировать фальшивые данные.

3. **Уязвимость к атаке 51%**:
   - Злонамеренные узлы могут захватить контроль над системой и навязать свои решения.

---

### Пример

1. **Система с \( N = 10 \)**:
   - Максимальное количество злонамеренных узлов:
     $$
     f = \lfloor \frac{10 - 1}{3} \rfloor = 3
     $$
   - Если \( f = 4 \), то:
     - Честных узлов:
       $$
       Honest = N - f = 10 - 4 = 6
       $$
     - Для кворума требуется:
       $$
       Honest = 2f + 1 = 9
       $$
   - Честные узлы не могут достичь кворума.

---

### Решение проблемы

1. **Механизмы предотвращения**:
   - Ограничить количество участников, которые могут действовать злонамеренно.
   - Использовать дополнительные механизмы проверки сообщений.

2. **Альтернативные алгоритмы**:
   - Консенсусы с Proof of Stake (PoS) могут использовать стейкинг как способ защиты от атак.

---

### Связанные темы

- [[Какое количество участников может быть злонамеренным для достижения консенсуса PBFT?]]
- [[Перечислите предположения PBFT. Опишите потенциальные проблемы, которые могут произойти если пренебречь любым из предположений.]]
- [[Что такое BFT (как метрика)?]]

---

### Источники

1. [PBFT Overview](https://blockgeeks.com/what-is-pbft/)
2. [Byzantine Fault Tolerance Concepts](https://developer.ibm.com/articles/what-is-pbft/)
3. [Understanding Consensus Mechanisms](https://cointelegraph.com/explained/what-is-consensus-mechanism-explained)

---