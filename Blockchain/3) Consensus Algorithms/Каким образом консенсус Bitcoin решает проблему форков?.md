[Вернуться к списку вопросов](3.%20Список%20вопросов)
## Короткий ответ

В **Bitcoin** форки разрешаются с помощью правила **наибольшей цепочки**: узлы сети принимают цепочку с наибольшей совокупной сложностью (chain with the most cumulative proof-of-work). Майнеры продолжают майнить на этой цепочке, а менее длинные цепочки отбрасываются.

---

## Подробный разбор

### Что такое форк?

1. **Определение**:
   - Форк возникает, когда два или более блока добавляются одновременно, создавая несколько параллельных цепочек.

2. **Причины форков**:
   - Одновременная добыча блоков двумя майнерами.
   - Разногласия в сети из-за задержек или ошибок передачи данных.

---

### Механизм решения форков

1. **Наибольшая цепочка**:
   - Узлы принимают цепочку с наибольшей совокупной сложностью (или длиной).

2. **Выбор цепочки**:
   - Если появляется цепочка с большей сложностью, узлы переключаются на неё.

3. **Пример**:
   - Два блока (A и B) добавлены одновременно:
     - Майнеры продолжают майнить на своих цепочках.
     - Цепочка, которая первой добавит следующий блок, становится основной.

---

### Устойчивость сети к форкам

1. **Временные форки**:
   - Большинство форков в Bitcoin разрешаются автоматически за 1–2 блока.

2. **Долгосрочные форки**:
   - Если сеть разделяется на длительный период, это может привести к созданию двух конкурентных цепочек.

3. **Роль сложности**:
   - Узлы всегда выбирают цепочку с наибольшей совокупной сложностью, что предотвращает случайное разделение.

---

### Пример работы

1. Майнер A и майнер B находят блоки одновременно.
2. Узлы сети начинают майнить на обоих блоках.
3. Если майнер C добавляет новый блок к блоку A:
   - Узлы переключаются на цепочку с A.

---

### Проблемы и ограничения

1. **Задержка транзакций**:
   - Транзакции из отбрасываемой цепочки возвращаются в mempool.

2. **Атаки с двойным списанием**:
   - Злоумышленник может воспользоваться форком для переписывания цепочки.

---

### Связанные темы

- [[Что такое атака 51%?]]
- [[Что такое сложность сети, от чего зависит? Как меняется сложность во времени? Что произойдет если не обновлять сложность?]]
- [[Расскажите о финализации блоков в Bitcoin.]]

---

### Источники

1. [Bitcoin Forks Explained](https://bitcoin.org/en/bitcoin-forks)
2. [Longest Chain Rule in Bitcoin](https://en.bitcoin.it/wiki/Chain)
3. [Fork Resolution in Blockchain](https://www.coindesk.com/learn/what-is-a-bitcoin-fork/)

---