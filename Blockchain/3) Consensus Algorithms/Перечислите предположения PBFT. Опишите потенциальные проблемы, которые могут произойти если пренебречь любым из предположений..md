[Вернуться к списку вопросов](3.%20Список%20вопросов)
## Короткий ответ

**PBFT** делает три ключевых предположения: 
1. Система состоит из \( N = 3f + 1 \) узлов, где \( f \) — максимальное количество злонамеренных узлов.
2. Узлы могут надёжно передавать сообщения друг другу.
3. Время доставки сообщений ограничено. 

Пренебрежение любым из предположений может привести к сбоям, несогласованности или полной остановке системы.

---

## Подробный разбор

### Основные предположения PBFT

1. **Количество узлов**:
   - Система должна иметь не менее \( N = 3f + 1 \) узлов, где \( f \) — максимальное количество злонамеренных узлов.
   - Это обеспечивает большинство честных узлов (\( 2f + 1 \)), необходимых для достижения консенсуса.

2. **Надёжная передача сообщений**:
   - Все сообщения между узлами должны быть доставлены, искажение или потеря сообщений недопустимы.
   - Предполагается наличие защищённого канала связи, где сообщения невозможно подделать.

3. **Ограниченное время доставки сообщений**:
   - PBFT предполагает, что сообщения достигают узлов в течение предсказуемого времени (нет бесконечных задержек).
   - Это важно для согласования состояния системы.

---

### Потенциальные проблемы при нарушении предположений

1. **Нарушение правила \( N = 3f + 1 \)**:
   - Если $$ f > \frac{N - 1}{3} $$, злонамеренные узлы могут захватить контроль над системой.
   - Пример:
     - При \( N = 6 \), если \( f = 3 \), честных узлов (\( N - f = 3 \)) недостаточно для согласия.

2. **Недоставка сообщений**:
   - Потеря сообщений между узлами приводит к невозможности достижения кворума.
   - Пример:
     - Узел A отправляет сообщение узлу B, но оно теряется из-за сетевых проблем. Узел B не может проверить состояние системы.

3. **Неограниченные задержки**:
   - Если сообщения достигают узлов с неопределённой задержкой, консенсус может затянуться или не завершиться вовсе.
   - Пример:
     - Узлы ожидают подтверждения от других участников, но из-за задержки система не может принять решение.

---

### Пример нарушения предположений

#### Сценарий

1. В системе \( N = 10 \), и \( f = 4 \) узла становятся злонамеренными.
2. Честные узлы (\( N - f = 6 \)) пытаются достичь кворума (\( 2f + 1 = 9 \)), но их недостаточно.
3. Результат:
   - Злонамеренные узлы начинают отправлять противоречивые сообщения.
   - Честные узлы не могут договориться, и консенсус не достигается.

---

### Рекомендации для обеспечения работы PBFT

1. **Контроль количества участников**:
   - Поддерживайте минимальное соотношение \( N = 3f + 1 \).

2. **Резервирование сетевых ресурсов**:
   - Обеспечьте надёжную передачу сообщений через защищённые каналы.

3. **Управление задержками**:
   - Используйте тайм-ауты для обнаружения задержек или сбойных узлов.

---

### Связанные темы

- [[Почему нельзя достигнуть консенсуса PBFT когда злонамеренных нод > 1 / 3 ?]]
- [[Как BFT применяется в блокчейне? Соотнесите сущности блокчейна системы с ролями или действиями BFT.]]
- [[Что такое задача византийских генералов? Какую проблему решает?]]

---

### Источники

1. [PBFT: Practical Byzantine Fault Tolerance](https://blockgeeks.com/what-is-pbft/)
2. [Understanding PBFT Mechanisms](https://cointelegraph.com/explained/practical-byzantine-fault-tolerance-explained)
3. [Distributed Systems: Fault Tolerance Explained](https://distributed-systems.net)

---