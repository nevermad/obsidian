---
tags: [блокчейн, распределенные-системы, lamport-timestamp, синхронизация-времени, упорядочивание-событий, консенсус]
aliases: [локальное время, сортировка предложений, timestamp, clock]
---

## Короткий ответ:

Использовать время из узлов для сортировки предложений в распределенной системе **не рекомендуется**, так как локальные часы узлов могут быть не синхронизированы. Это может привести к некорректному порядку выполнения операций. Рекомендуется использовать логические часы, такие как Lamport Clock.

## Подробный разбор:

**Проблемы использования локального времени:**

* **Отсутствие синхронизации:** Узлы в распределенной системе имеют свои локальные часы, которые могут расходиться из-за дрейфа часов, задержек сети и других факторов.  
* **Невозможность гарантировать порядок:** Если узел A отправит предложение с временем 10:00, а узел B отправит предложение с временем 10:01,  нет гарантии, что предложение A было создано раньше. Время на узле B могло отставать.
* **Уязвимость к атакам:** Злоумышленник может манипулировать временем на своем узле, чтобы повлиять на порядок предложений.


**Почему Lamport Clock лучше:**

Lamport Clock  позволяет установить **частичный порядок** событий в распределенной системе, основываясь на **причинно-следственных связях**, а не на физическом времени.  Это гарантирует, что если событие A произошло раньше события B, то Lamport Timestamp для A будет меньше, чем для B.

**Как Lamport Clock решает проблему:**

* **Логические метки времени:** Lamport Clock использует счетчики, которые увеличиваются при каждом событии и обмене сообщениями.
* **Отражение причинно-следственной связи:** Правила обновления счетчиков гарантируют, что если событие A повлияло на событие B, то timestamp A будет меньше timestamp B.
* **Независимость от физического времени:** Порядок событий определяется логикой алгоритма, а не локальным временем узлов.



**Альтернативные решения:**

* **Vector Clocks:** Расширение Lamport Clock, которое позволяет определить, являются ли события **одновременными** (concurrent).
* **Протоколы синхронизации времени (например, NTP):** Могут улучшить точность локальных часов, но не гарантируют полной синхронизации.  Даже небольшая разница во времени может привести к ошибкам в  системах с высокой нагрузкой.  Использование NTP в блокчейне **нецелесообразно**, так как это противоречит принципу децентрализации.


## Связанные темы:

* [[Что такое Lamport timestamp, Lamport clock?]]
* [[Как решить проблему конфликтов?]]
* [[Опишите суть проблемы последовательного принятия предложений?]]
* [Вернуться к списку вопросов](3.%20Список%20вопросов)



## Источники:

* [Lamport's Time, Clocks, and the Ordering of Events in a Distributed System](https://lamport.azurewebsites.net/pubs/time-clocks.pdf)