[Вернуться к списку вопросов](3.%20Список%20вопросов)
## Короткий ответ

**Paxos** — это консенсус алгоритм, который позволяет узлам распределённой системы договориться о едином решении. Основные роли в Paxos: **Proposer** (предлагает решение), **Acceptor** (принимает решение), **Learner** (запоминает результат). Узлы взаимодействуют через два основных этапа: **Phase 1** (подготовка) и **Phase 2** (принятие предложения).

---

## Подробный разбор

### Основные роли в Paxos

1. **Proposer (Предлагающий)**:
   - Отправляет предложения для принятия (proposals).
   - У каждого предложения есть уникальный идентификатор \( n \) (номер предложения).

2. **Acceptor (Принимающий)**:
   - Принимает или отклоняет предложение.
   - Хранит:
     - Наивысший номер предложения \( n \), который был виден.
     - Значение \( v \), которое было принято.

3. **Learner (Обучающийся)**:
   - Получает результат согласования от Acceptors.
   - Использует это решение, но не участвует в самом процессе голосования.

---

### Механизм работы Paxos

Paxos работает в два основных этапа:

#### Phase 1: Подготовка (Prepare)

1. **Proposer** отправляет запрос Prepare с номером \( n \) всем **Acceptor**.
2. Каждый **Acceptor**:
   - Отвечает **Promise**, если $$ n > n_{max} $$, где $$ n_{max} $$ — наибольший ранее полученный номер предложения.
   - Отправляет $$ v_{accepted} $$ (последнее принятое значение).

#### Phase 2: Принятие (Accept)

1. **Proposer** отправляет предложение Accept с \( n \) и \( v \) (значение, соответствующее последнему принятому \( v_{accepted} \), если такое было; иначе — новое значение).
2. Каждый **Acceptor**:
   - Принимает предложение, если $$ n \geq n_{max} $$, обновляя свои $$ n_{max} $$ и $$ v_{accepted} $$

---

### Пример работы Paxos

1. **Сценарий**:
   - Система имеет 3 узла: A, B, C.
   - Proposer отправляет предложение \( n = 1 \) с \( v = "Update A" \).

2. **Этап Prepare**:
   - Узлы A, B, C отвечают Proposer, что они готовы принять \( n = 1 \).

3. **Этап Accept**:
   - Proposer отправляет \( n = 1 \), \( v = "Update A" \) всем узлам.
   - Узлы фиксируют \( v = "Update A" \).

4. **Результат**:
   - Все узлы соглашаются на \( v = "Update A" \).

---

### Основные свойства Paxos

1. **Safety (безопасность)**:
   - Только одно значение может быть согласовано.

2. **Liveness (жизнеспособность)**:
   - Если большинство узлов активно, согласование завершится.

3. **Fault Tolerance**:
   - Paxos выдерживает сбои до $$ \frac{N}{2} $$ узлов.

---

### Преимущества Paxos

1. Гарантированное согласование.
2. Высокая устойчивость к сбоям.

---

### Недостатки Paxos

1. Сложность реализации.
2. Низкая производительность при высоких нагрузках.

---

### Связанные темы

- [[Что происходит в phase 1, phase 2? Что такое n, v?]]
- [[Что такое Quorum?]]
- [[Что такое Lamport timestamp, Lamport clock?]]

---

### Источники

1. [Paxos Made Simple](https://lamport.azurewebsites.net/pubs/paxos-simple.pdf)
2. [Distributed Systems: Paxos Explained](https://distributed-systems.net)
3. [Understanding Paxos](https://jepsen.io/)

---