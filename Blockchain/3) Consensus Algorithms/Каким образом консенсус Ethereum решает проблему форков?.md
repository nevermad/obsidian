[Вернуться к списку вопросов](3.%20Список%20вопросов)
## Короткий ответ

В **Ethereum**, использующем Proof of Stake (PoS), проблема форков решается через выбор основной цепочки на основе голосования валидаторов. Финализация достигается через механизм Casper, где блоки с достаточным количеством голосов становятся необратимыми.

---

## Подробный разбор

### Проблема форков

1. **Причины форков**:
   - Одновременное создание блоков несколькими валидаторами.
   - Задержки в передаче данных между узлами.

2. **Последствия форков**:
   - Временные разделения цепочки.
   - Возможные атаки с двойным списанием.

---

### Решение проблемы форков в Ethereum

1. **Финализация Casper**:
   - Валидаторы голосуют за чекпоинты, состоящие из нескольких блоков.
   - Чекпоинты с \( \geq 2/3 \) голосов считаются финализированными.

2. **Выбор основной цепочки**:
   - Используется правило **наибольшего веса**:
     - Цепочка с наибольшим количеством стейков, поддерживающих её, становится основной.

3. **Отбрасывание ветвей**:
   - Форки, не получившие поддержки валидаторов, игнорируются сетью.

---

### Пример

1. **Создание форков**:
   - Валидаторы A и B одновременно создают блоки \( B_1 \) и \( B_2 \).
2. **Голосование**:
   - Остальные валидаторы голосуют за один из блоков.
3. **Решение**:
   - Блок \( B_1 \), получивший больше голосов, включается в основную цепочку.

---

### Преимущества подхода

1. **Быстрая финализация**:
   - Чекпоинты предотвращают длительное существование форков.

2. **Экономическая безопасность**:
   - Валидаторы заинтересованы голосовать за правильную цепочку, чтобы не потерять stake.

---

### Связанные темы

- [[Как работает механизм финализации Сasper?(основная суть)]]
- [[Что такое финализация?]]
- [[Как консенсус POS определяет активного валидатора / block proposer?]]

---

### Источники

1. [Ethereum Fork Resolution](https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/)
2. [Understanding Casper Protocol](https://ethereum.org/en/developers/docs/consensus-mechanisms/casper/)
3. [Forks in Ethereum](https://www.coindesk.com/learn/what-is-a-ethereum-fork/)

---