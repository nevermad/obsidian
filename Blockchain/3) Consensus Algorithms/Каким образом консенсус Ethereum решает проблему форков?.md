---
tags: [блокчейн, ethereum, консенсус, proof-of-stake, pos, форк, casper, финализация]
aliases: [ethereum форки, разрешение форков в ethereum]
---
## Короткий ответ:

В Ethereum, использующем Proof-of-Stake (PoS), форки разрешаются путем голосования валидаторов и механизма финализации Casper FFG. Casper FFG гарантирует, что финализированные блоки не могут быть отменены, предотвращая долгосрочные форки.

## Подробный разбор:

**Как возникают форки в Ethereum PoS:**

Форки в Ethereum PoS  могут возникать по нескольким причинам:

* **Одновременное предложение блоков:** Два валидатора могут быть выбраны для предложения блока в один и тот же слот, создавая две конкурирующие цепочки.
* **Сетевые задержки:**  Распространение блоков по сети может занимать разное время, что может привести к временному расхождению в представлениях о текущем состоянии цепочки у разных узлов.
* **Злонамеренное поведение валидаторов:** Валидаторы могут пытаться создать альтернативные цепочки в своих интересах.


**Разрешение форков:**

1. **Выбор цепочки на основе LMD-GHOST:** Ethereum использует модифицированный алгоритм GHOST (Greedy Heaviest Observed Subtree), который учитывает не только самую длинную, но и самую "тяжелую" цепочку,  где "вес" определяется количеством аттестаций (подтверждений) от валидаторов.  Это помогает быстрее разрешать  кратковременные форки.

2. **Финализация с Casper FFG:**   Casper FFG (Friendly Finality Gadget) - это механизм, который позволяет валидаторам голосовать за "чекпоинты" (контрольные точки) в блокчейне.  Когда 2/3 валидаторов голосуют за определенный чекпойнт,  все блоки до этого чекпойнта считаются **финализированными**.  Финализированные блоки **не могут быть отменены**,  что предотвращает  долгосрочные форки и  атаки с двойным расходованием.


**Преимущества Casper FFG:**

* **Быстрая финализация:** Casper FFG  позволяет быстро достигать финальности,  обычно в течение нескольких минут.
* **Экономическая безопасность:**  Валидаторы,  действующие злонамеренно,  рискуют потерять свой стейк (slashing),  что делает атаки на сеть экономически невыгодными.
* **Защита от атаки 51%:**  Casper FFG  значительно усложняет атаку 51%,  так как злоумышленнику нужно контролировать не только большую часть стейка, но и убедить  честных валидаторов голосовать за неверную цепочку,  что маловероятно из-за риска slashing.

## Связанные темы:

* [[Как работает механизм финализации Сasper?(основная суть)]]
* [[Что такое финализация?]]
* [[Как консенсус POS определяет активного валидатора / block proposer?]]
* [Вернуться к списку вопросов](3.%20Список%20вопросов)

## Источники:

* [Ethereum Foundation Blog: Proof-of-Stake](https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/)
* [Vitalik Buterin's Blog: Casper FFG](https://vitalik.ca/general/2023/05/25/attestation.html)